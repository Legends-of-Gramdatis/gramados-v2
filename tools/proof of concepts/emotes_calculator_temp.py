# -*- coding: utf-8 -*-
import json
import csv

# ===============================
# Functions to calculate page/coords
# ===============================
def ascii_to_page_coords(ascii_code):
    """Convert a Unicode character to page number and coordinates."""
    if isinstance(ascii_code, str):
        code_int = ord(ascii_code)  # get the code point
    else:
        code_int = ascii_code

    page_number = code_int >> 8
    offset_in_page = code_int & 0xFF
    row = offset_in_page >> 4
    col = offset_in_page & 0xF

    return page_number, row, col


# ===============================
# Example JSON (replace this with loading your JSON file)
# ===============================
CHAT_EMOTES = {
    "check_mark": "\u9366",
    "cross_mark": "\u9367",
    "sun": "\u2739",
    "star": "\u2729",
    "recycle": "\u267B",
    "seagull": "\u932A",
    "cool": "\u9914",
    "shocked": "\u9915",
    "smile": "\u9916",
    "joy": "\u9917",
    "wink": "\u9918",
    "happy": "\u9919",
    "crazy": "\u991A",
    "shrug": "\u991B",
    "thonk": "\u950B",
    "heart": "\u93E7",
    "heart_gold": "\u93F2",
    "heart_wither": "\u93F1",
    "heart_dark": "\u9416",
    "wifi5": "\u936A",
    "wifi4": "\u936B",
    "wifi3": "\u936C",
    "wifi2": "\u936D",
    "wifi1": "\u936E",
    "wifi0": "\u936F",
    "lang": "\u935C",
    "money": "\u932B",
    "trin": "\u932D",
    "unu": "\u932E",
    "wheel": "\u9509",
    "folder": "\u932F",
    "thumbsup": "\u93F3",
    "thumbsdown": "\u93F4",
    "bomb": "\u93F5",
    "hazard": "\u93F6",
    "ying": "\u93F7",
    "danger": "\u93F8",
    "noperm": "\u93F9",
    "gear": "\u93FA",
    "stats": "\u93FB",
    "medal_choco": "\u9508",
    "medal_bronze": "\u9507",
    "medal_silver": "\u9506",
    "medal_gold": "\u9505",
    "medal_diamond": "\u9504",
    "medal_emerald": "\u9503",
    "medal": "\u9502",
    "trophy": "\u950A",
    "unlock": "\u937E",
    "lock": "\u937F",
    "car": "\u950D",
    "computer": "\u950E",
    "factory": "\u950F",
    "arrow_u": "\u9920",
    "arrow_ur": "\u9921",
    "arrow_r": "\u9922",
    "arrow_dr": "\u9923",
    "arrow_d": "\u9924",
    "arrow_dl": "\u9925",
    "arrow_l": "\u9926",
    "arrow_ul": "\u9927",
    "clock_day": "\u9048",
    "clock_1": "\u9049",
    "clock_2": "\u904A",
    "clock_3": "\u904B",
    "clock_night": "\u904C",
    "clock_4": "\u904D",
    "clock_5": "\u904E",
    "clock_6": "\u904F",
    "bed": "\u90A9",
    "demonic_ingot": "\u93CB",
    "mithril_ingot": "\u93CC",
    "iron_ingot": "\u90B0",
    "gold_ingot": "\u90B1",
    "brick": "\u90B2",
    "nether_brick": "\u90B3",
    "diamond": "\u90B6",
    "ruby": "\u90B7",
    "emerald": "\u90B8",
    "sapphire": "\u93FC",
    "amethyst": "\u93CE",
    "nether_star": "\u90BD",
    "exp": "\u9901",
    "book_quill": "\u9062",
    "gapple": "\u9902",
    "creamcookie": "\u932C",
    "bread": "\u90EA",
    "cookie": "\u90EB",
    "cake": "\u90EC",
    "ppie": "\u90ED",
    "egg": "\u906C",
    "fish": "\u90E4",
    "meat_small": "\u95A7",
    "meat_medium": "\u95A9",
    "meat_big": "\u95A8",
    "meat_prime": "\u95AA",
    "meat_gold": "\u95AB",
    "lit": "\u9200",
    "hp": "\u9390",
    "hphalf": "\u9391",
    "hpempty": "\u938E",
    "coal": "\u90B4",
    "ccoal": "\u90B5",
    "dead_bush": "\u91B4",
    "swiftness": "\u93E0",
    "slowness": "\u93E1",
    "haste": "\u93E2",
    "mining_fatigue": "\u93E3",
    "strength": "\u93E4",
    "weakness": "\u93E5",
    "poison": "\u93E6",
    "invisibility": "\u93E8",
    "hunger": "\u93E9",
    "jump_rabbit": "\u93EA",
    "nausea": "\u93EB",
    "mossy_log": "\u9466",
    "fountain": "\u9462",
    "fountain_desert": "\u9440",
    "hut_dirt": "\u946B",
    "hut_wooden": "\u9469",
    "hut_brick": "\u946A",
    "castle": "\u946D",
    "brewers_kit": "\u9453",
    "empire_block": "\u9500",
    "empire_ornate": "\u9501",
    "coal_ore": "\u9220",
    "iron_ore": "\u9221",
    "gold_ore": "\u9222",
    "redstone_ore": "\u9223",
    "diamond_ore": "\u9224",
    "lapis_ore": "\u9225",
    "emerald_ore": "\u9226",
    "coal_block": "\u9230",
    "iron_block": "\u9231",
    "gold_block": "\u9232",
    "redstone_block": "\u9233",
    "diamond_block": "\u9234",
    "lapis_block": "\u9235",
    "emerals_block": "\u9236",
    "cobble": "\u9227",
    "mosscobble": "\u9228",
    "stone": "\u9229",
    "chest": "\u92F9",
    "enderchest": "\u92FB",
    "giftchest": "\u92FC",
    "pumpkin": "\u9270",
    "jacklantern": "\u9271",
    "melon": "\u9274",
    "cactus": "\u9276",
    "sponge": "\u927C",
    "tnt": "\u927E",
    "fire": "\u95AF",
    "water": "\u920B",
    "lava": "\u920E",
    "portal": "\u920F",
    "log": "\u926B",
    "log2": "\u926C",
    "wood": "\u926D",
    "bookcase": "\u926E",
    "trapdoor": "\u926F",
    "lamp_on": "\u9248",
    "lamp_off": "\u9247",
    "creeper": "\u92C0",
    "ccreeper": "\u92C1",
    "skeleton": "\u92C2",
    "wskeleton": "\u92C3",
    "spider": "\u92C4",
    "zombie": "\u92C5",
    "vzombie": "\u92C6",
    "slime": "\u92C7",
    "ghast": "\u94D2",
    "oghast": "\u94D3",
    "pigzombie": "\u94D4",
    "enderman": "\u94D5",
    "blaze": "\u94D8",
    "silverfish": "\u94D7",
    "mslime": "\u94D9",
    "illager": "\u92D1",
    "pig": "\u92D3",
    "sheep": "\u92D4",
    "cow": "\u92D5",
    "chicken": "\u92D6",
    "villager": "\u92E5",
    "seastar": "\u91AA",
    "seashell": "\u91AB",
    "cobweb": "\u91CF",
    "railsv": "\u91E0",
    "railsh": "\u91E8",
    "rails_ru": "\u91F0",
    "rails_lu": "\u91F1",
    "rails_rd": "\u91E1",
    "rails_ld": "\u91E9",
    "prailsv_off": "\u91E2",
    "prailsv_on": "\u91E3",
    "drailsv_off": "\u91E4",
    "drailsv_on": "\u91E5",
    "arailsv_off": "\u91E6",
    "arailsv_on": "\u91E7",
    "prailsh_off": "\u91EA",
    "prailsh_on": "\u91EB",
    "drailsh_off": "\u91EC",
    "drailsh_on": "\u91ED",
    "arailsh_off": "\u91EE",
    "arailsh_on": "\u91EF",
    "flint_and_steel": "\u9053",
    "wooden_sword": "\u9000",
    "wooden_pickaxe": "\u9001",
    "wooden_shovel": "\u9002",
    "wooden_axe": "\u9003",
    "wooden_hoe": "\u9004",
    "stone_sword": "\u9005",
    "stone_pickaxe": "\u9006",
    "stone_shovel": "\u9007",
    "stone_axe": "\u9008",
    "stone_hoe": "\u9009",
    "golden_sword": "\u900A",
    "golden_pickaxe": "\u900B",
    "golden_shovel": "\u900C",
    "golden_axe": "\u900D",
    "golden_hoe": "\u900E",
    "iron_sword": "\u9010",
    "iron_pickaxe": "\u9011",
    "iron_shovel": "\u9012",
    "iron_axe": "\u9013",
    "iron_hoe": "\u9014",
    "diamond_sword": "\u9015",
    "diamond_pickaxe": "\u9016",
    "diamond_shovel": "\u9017",
    "diamond_axe": "\u9018",
    "diamond_hoe": "\u9019",
    "box": "\u2B1B",
    "gun": "\u9684",
    "shotgun": "\u950C",
    "rifle": "\u9683"
}

# ===============================
# Export to CSV
# ===============================
output_file = "reports/emotes_pages.csv"

with open(output_file, "w", newline="", encoding="utf-8") as csvfile:
    writer = csv.writer(csvfile)
    # header
    writer.writerow(["emote_name", "unicode", "page", "row", "col"])

    for name, code in CHAT_EMOTES.items():
        page, row, col = ascii_to_page_coords(code)
        unicode_str = f"\\u{ord(code):04X}"
        writer.writerow([name, unicode_str, format(page, 'X').upper(), row, col])

print(f"CSV file '{output_file}' generated successfully!")
